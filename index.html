<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tomo - Virtual Pet Game</title>
    <meta name="description" content="Raise your own cute digital pet! Free online virtual pet game">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=DotGothic16&display=swap" rel="stylesheet">
    
    <!-- Google AdSense -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7228257979516051" crossorigin="anonymous"></script>
    
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        :root {
            --screen-bg: #c4cfa1;
            --screen-pixel: #414141;
        }
        body {
            font-family: 'DotGothic16', monospace;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }
        .game-title {
            font-size: 2rem; color: white;
            text-shadow: 3px 3px 0 rgba(0,0,0,0.3);
            margin-bottom: 15px; letter-spacing: 2px;
        }
        .cover-selector {
            display: flex; gap: 10px; margin-bottom: 20px;
            flex-wrap: wrap; justify-content: center;
        }
        .cover-btn {
            width: 40px; height: 40px; border-radius: 8px;
            border: 3px solid rgba(255,255,255,0.5);
            cursor: pointer; transition: all 0.2s;
        }
        .cover-btn:hover { transform: scale(1.1); border-color: white; }
        .cover-btn.active { border-color: white; box-shadow: 0 0 15px rgba(255,255,255,0.5); }
        /* Solid colors */
        .cover-btn.red { background: linear-gradient(145deg, #e74c3c, #c0392b); }
        .cover-btn.blue { background: linear-gradient(145deg, #3498db, #2980b9); }
        .cover-btn.green { background: linear-gradient(145deg, #2ecc71, #27ae60); }
        /* Patterns */
        .cover-btn.checkerboard {
            background: repeating-conic-gradient(#333 0% 25%, #f0f0f0 0% 50%) 50% / 12px 12px;
        }
        .cover-btn.stripes {
            background: repeating-linear-gradient(45deg, #ff6b6b, #ff6b6b 4px, #ffd93d 4px, #ffd93d 8px);
        }
        .cover-btn.dots {
            background: radial-gradient(circle, #fff 2px, transparent 2px), #9b59b6;
            background-size: 8px 8px;
        }
        .cover-btn.rainbow {
            background: linear-gradient(90deg, #ff0000, #ff7f00, #ffff00, #00ff00, #0000ff, #4b0082, #8f00ff);
        }
        .cover-btn.camo {
            background: 
                radial-gradient(ellipse at 30% 20%, #556b2f 20%, transparent 50%),
                radial-gradient(ellipse at 70% 60%, #2f4f4f 25%, transparent 55%),
                radial-gradient(ellipse at 50% 80%, #6b8e23 15%, transparent 45%),
                #8fbc8f;
        }
        .cover-btn.galaxy {
            background: radial-gradient(ellipse at 30% 30%, #667eea 0%, transparent 50%),
                radial-gradient(ellipse at 70% 70%, #764ba2 0%, transparent 50%),
                radial-gradient(circle at 50% 50%, #0c0c0c 0%, #1a1a2e 100%);
        }
        .cover-btn.retro {
            background: linear-gradient(135deg, #f5af19 0%, #f12711 50%, #f5af19 100%);
        }
        .cover-btn.pixel {
            background: 
                linear-gradient(90deg, #333 50%, transparent 50%),
                linear-gradient(#333 50%, transparent 50%),
                #8b5cf6;
            background-size: 8px 8px;
        }
        .cover-btn.wood {
            background: repeating-linear-gradient(90deg, #8b4513 0px, #a0522d 2px, #8b4513 4px, #cd853f 6px, #8b4513 8px);
        }

        /* Main container - device + stats panel */
        .main-container {
            display: flex;
            gap: 30px;
            align-items: flex-start;
            justify-content: center;
            flex-wrap: wrap;
        }

        .device {
            position: relative; width: 260px; height: 420px;
            filter: drop-shadow(0 20px 40px rgba(0,0,0,0.4));
        }
        .device-body {
            position: absolute; width: 100%; height: 100%;
            background: linear-gradient(145deg, #e74c3c, #c0392b);
            border-radius: 20px 20px 20px 20px;
            box-shadow: 
                inset 0 2px 0 rgba(255,255,255,0.3),
                inset 0 -4px 0 rgba(0,0,0,0.2),
                inset 4px 0 0 rgba(255,255,255,0.1),
                inset -4px 0 0 rgba(0,0,0,0.1);
            transition: background 0.3s;
        }
        /* Solid colors */
        .device-body.red { background: linear-gradient(145deg, #e74c3c, #c0392b); }
        .device-body.blue { background: linear-gradient(145deg, #3498db, #2980b9); }
        .device-body.green { background: linear-gradient(145deg, #2ecc71, #27ae60); }
        /* Patterns */
        .device-body.checkerboard {
            background: repeating-conic-gradient(#333 0% 25%, #f0f0f0 0% 50%) 50% / 20px 20px;
        }
        .device-body.stripes {
            background: repeating-linear-gradient(45deg, #ff6b6b, #ff6b6b 10px, #ffd93d 10px, #ffd93d 20px);
        }
        .device-body.dots {
            background: radial-gradient(circle, #fff 3px, transparent 3px), #9b59b6;
            background-size: 15px 15px;
        }
        .device-body.rainbow {
            background: linear-gradient(180deg, #ff0000 0%, #ff7f00 16%, #ffff00 33%, #00ff00 50%, #0000ff 66%, #4b0082 83%, #8f00ff 100%);
        }
        .device-body.camo {
            background: 
                radial-gradient(ellipse at 30% 20%, #556b2f 20%, transparent 50%),
                radial-gradient(ellipse at 70% 60%, #2f4f4f 25%, transparent 55%),
                radial-gradient(ellipse at 50% 80%, #6b8e23 15%, transparent 45%),
                radial-gradient(ellipse at 20% 70%, #556b2f 18%, transparent 48%),
                radial-gradient(ellipse at 80% 30%, #2f4f4f 20%, transparent 50%),
                #8fbc8f;
        }
        .device-body.galaxy {
            background: 
                radial-gradient(ellipse at 30% 30%, #667eea 0%, transparent 50%),
                radial-gradient(ellipse at 70% 70%, #764ba2 0%, transparent 50%),
                radial-gradient(ellipse at 60% 20%, rgba(255,255,255,0.1) 0%, transparent 20%),
                radial-gradient(ellipse at 20% 80%, rgba(255,255,255,0.1) 0%, transparent 15%),
                radial-gradient(circle at 50% 50%, #0c0c0c 0%, #1a1a2e 100%);
        }
        .device-body.retro {
            background: 
                linear-gradient(135deg, transparent 40%, rgba(0,0,0,0.1) 40%, rgba(0,0,0,0.1) 60%, transparent 60%),
                linear-gradient(135deg, #f5af19 0%, #f12711 50%, #f5af19 100%);
        }
        .device-body.pixel {
            background: 
                linear-gradient(90deg, rgba(0,0,0,0.1) 50%, transparent 50%),
                linear-gradient(rgba(0,0,0,0.1) 50%, transparent 50%),
                linear-gradient(145deg, #8b5cf6, #6d28d9);
            background-size: 15px 15px, 15px 15px, 100% 100%;
        }
        .device-body.wood {
            background: 
                repeating-linear-gradient(90deg, 
                    #8b4513 0px, #a0522d 3px, #8b4513 6px, #cd853f 9px, #8b4513 12px,
                    #a0522d 15px, #cd853f 18px, #8b4513 21px);
        }

        .device-top {
            position: absolute; top: 0; left: 50%; transform: translateX(-50%);
            width: 80px; height: 15px; background: inherit;
            border-radius: 5px 5px 0 0;
            margin-top: -10px;
        }
        .device-notch {
            position: absolute; top: 8px; left: 50%; transform: translateX(-50%);
            width: 40px; height: 8px; background: rgba(0,0,0,0.3);
            border-radius: 0 0 5px 5px;
        }
        .screen-frame {
            position: absolute; top: 40px; left: 50%; transform: translateX(-50%);
            width: 200px; height: 180px; background: #1a1a1a;
            border-radius: 10px; padding: 10px;
            box-shadow: inset 0 4px 15px rgba(0,0,0,0.5);
            border: 3px solid #333;
        }
        .screen-label {
            position: absolute; top: 225px; left: 50%; transform: translateX(-50%);
            font-size: 14px; color: rgba(255,255,255,0.8); font-weight: bold;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
            letter-spacing: 3px;
        }
        .speaker-grille {
            position: absolute; top: 255px; right: 30px;
            display: flex; flex-direction: column; gap: 3px;
        }
        .speaker-line {
            width: 30px; height: 2px; background: rgba(0,0,0,0.3);
            border-radius: 1px;
        }
        .screen {
            width: 100%; height: 100%; background: var(--screen-bg);
            border-radius: 8px; position: relative; overflow: hidden;
            transition: filter 0.5s;
        }
        .screen.lights-off { filter: brightness(0.3); }
        .screen::after {
            content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0;
            background: repeating-linear-gradient(0deg, rgba(0,0,0,0.03) 0px, rgba(0,0,0,0.03) 1px, transparent 1px, transparent 2px);
            pointer-events: none;
        }
        .screen-icons {
            position: absolute; top: 4px; left: 4px; right: 4px;
            display: flex; justify-content: space-between; font-size: 10px;
        }
        .screen-icon { width: 16px; height: 16px; display: flex; align-items: center; justify-content: center; opacity: 0.3; }
        .screen-icon.active { opacity: 1; animation: blink 0.5s infinite; }
        @keyframes blink { 50% { opacity: 0.5; } }

        .pixel-pet-container {
            position: absolute; top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            display: flex; flex-direction: column; align-items: center;
        }
        .pixel-pet {
            display: grid;
            grid-template-columns: repeat(16, 6px);
            grid-template-rows: repeat(16, 6px);
            animation: bounce 1s ease-in-out infinite;
        }
        .pixel-pet.sleeping { animation: sleep-bounce 2s ease-in-out infinite; }
        .pixel-pet.eating { animation: eat 0.3s ease-in-out infinite; }
        .pixel-pet.playing { animation: wiggle 0.4s ease-in-out infinite; }
        .pixel-pet.sick { animation: sick-shake 0.3s ease-in-out infinite; }
        @keyframes bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-4px); } }
        @keyframes sleep-bounce { 0%, 100% { transform: scale(1); } 50% { transform: scale(0.95); } }
        @keyframes eat { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.05); } }
        @keyframes wiggle { 0%, 100% { transform: rotate(-3deg); } 50% { transform: rotate(3deg); } }
        @keyframes sick-shake { 0%, 100% { transform: translateX(0); } 25% { transform: translateX(-2px); } 75% { transform: translateX(2px); } }

        .pixel { width: 6px; height: 6px; background: transparent; }
        .pixel.on { background: var(--screen-pixel); }

        .zzz-display {
            position: absolute; top: 30px; right: 15px;
            font-size: 12px; color: var(--screen-pixel);
            display: none;
        }
        .zzz-display.active { display: block; animation: zzz-float 1.5s ease-in-out infinite; }
        @keyframes zzz-float { 0%, 100% { opacity: 1; transform: translateY(0); } 50% { opacity: 0.5; transform: translateY(-5px); } }

        .poop-display {
            position: absolute; bottom: 30px; font-size: 10px; color: var(--screen-pixel);
        }
        .poop-display.left { left: 10px; }
        .poop-display.right { right: 10px; }

        .stats-display {
            position: absolute; bottom: 20px; left: 8px; right: 8px;
            display: flex; justify-content: space-around;
        }
        .mini-stat-bar {
            width: 24px; height: 4px; background: rgba(0,0,0,0.2);
            border: 1px solid var(--screen-pixel);
        }
        .mini-stat-fill { height: 100%; background: var(--screen-pixel); transition: width 0.3s; }

        .pet-info {
            position: absolute; bottom: 6px; left: 50%; transform: translateX(-50%);
            font-size: 7px; color: var(--screen-pixel);
        }
        .message-bubble {
            position: absolute; top: 28px; left: 50%; transform: translateX(-50%);
            font-size: 8px; color: var(--screen-pixel); text-align: center; max-width: 140px;
        }

        .controls-area {
            position: absolute; bottom: 30px; left: 0; right: 0;
            display: flex; justify-content: space-between; align-items: center;
            padding: 0 25px;
        }
        .dpad {
            position: relative; width: 70px; height: 70px;
        }
        .dpad-center {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            width: 24px; height: 24px; background: #333;
            border-radius: 4px;
        }
        .dpad-btn {
            position: absolute; width: 24px; height: 24px;
            background: linear-gradient(145deg, #444, #222);
            border: none; cursor: pointer; border-radius: 3px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }
        .dpad-btn:active { transform: scale(0.95); }
        .dpad-up { top: 0; left: 50%; transform: translateX(-50%); border-radius: 5px 5px 3px 3px; }
        .dpad-down { bottom: 0; left: 50%; transform: translateX(-50%); border-radius: 3px 3px 5px 5px; }
        .dpad-left { left: 0; top: 50%; transform: translateY(-50%); border-radius: 5px 3px 3px 5px; }
        .dpad-right { right: 0; top: 50%; transform: translateY(-50%); border-radius: 3px 5px 5px 3px; }
        
        .action-buttons {
            display: flex; gap: 10px; align-items: center;
        }
        .btn {
            width: 40px; height: 40px; border-radius: 50%; border: none;
            background: linear-gradient(145deg, #e74c3c, #c0392b);
            box-shadow: 0 4px 0 #922b21, 0 6px 10px rgba(0,0,0,0.3);
            cursor: pointer; font-size: 11px; font-weight: bold;
            color: white; text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
            display: flex; align-items: center; justify-content: center;
        }
        .btn:active { transform: translateY(2px); box-shadow: 0 2px 0 #922b21; }
        .btn.btn-b { background: linear-gradient(145deg, #f39c12, #d68910); box-shadow: 0 4px 0 #b9770e, 0 6px 10px rgba(0,0,0,0.3); }
        .btn.btn-b:active { box-shadow: 0 2px 0 #b9770e; }
        .btn.btn-c { background: linear-gradient(145deg, #27ae60, #1e8449); box-shadow: 0 4px 0 #196f3d, 0 6px 10px rgba(0,0,0,0.3); }
        .btn.btn-c:active { box-shadow: 0 2px 0 #196f3d; }

        .bottom-buttons {
            position: absolute; bottom: 120px; left: 50%; transform: translateX(-50%);
            display: flex; gap: 20px;
        }
        .small-btn {
            padding: 4px 12px; font-size: 8px; font-family: inherit;
            background: linear-gradient(145deg, #666, #444);
            color: #aaa; border: none; border-radius: 10px;
            cursor: pointer; text-transform: uppercase;
            box-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }
        .small-btn:active { transform: scale(0.95); }

        /* Stats Panel */
        .stats-panel {
            background: rgba(255,255,255,0.15);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 20px;
            min-width: 200px;
            color: white;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
        }
        .stats-panel h3 {
            font-size: 16px;
            margin-bottom: 15px;
            text-align: center;
            border-bottom: 2px solid rgba(255,255,255,0.3);
            padding-bottom: 10px;
        }
        .stat-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
            font-size: 13px;
        }
        .stat-label {
            opacity: 0.8;
        }
        .stat-value {
            font-weight: bold;
        }
        .stat-bar-container {
            width: 100%;
            margin-top: 5px;
        }
        .stat-bar-outer {
            width: 100%;
            height: 8px;
            background: rgba(0,0,0,0.2);
            border-radius: 4px;
            overflow: hidden;
        }
        .stat-bar-inner {
            height: 100%;
            border-radius: 4px;
            transition: width 0.3s ease;
        }
        .stat-bar-inner.hunger { background: linear-gradient(90deg, #ff6b6b, #ffa502); }
        .stat-bar-inner.happy { background: linear-gradient(90deg, #ffd93d, #6bcb77); }
        .stat-bar-inner.energy { background: linear-gradient(90deg, #4facfe, #00f2fe); }
        .stat-bar-inner.clean { background: linear-gradient(90deg, #a8edea, #fed6e3); }
        .stat-bar-inner.exp { background: linear-gradient(90deg, #f093fb, #f5576c); }

        .stat-divider {
            border: none;
            border-top: 1px solid rgba(255,255,255,0.2);
            margin: 15px 0;
        }

        .bottom-controls {
            display: flex; gap: 8px; margin-top: 20px; flex-wrap: wrap; justify-content: center;
        }
        .control-btn {
            background: rgba(255,255,255,0.2);
            border: 2px solid rgba(255,255,255,0.5);
            color: white; padding: 8px 12px; border-radius: 20px;
            font-family: inherit; font-size: 11px; cursor: pointer;
        }
        .control-btn:hover { background: rgba(255,255,255,0.3); border-color: white; }
        .control-btn:disabled { opacity: 0.5; cursor: not-allowed; }

        .modal {
            display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.8); align-items: center; justify-content: center; z-index: 1000;
        }
        .modal.active { display: flex; }
        .modal-content {
            background: white; padding: 25px; border-radius: 20px;
            text-align: center; max-width: 320px; width: 90%;
        }
        .modal-content h2 { margin-bottom: 15px; color: #333; font-size: 18px; }
        .modal-content p { margin-bottom: 10px; color: #666; font-size: 14px; }
        .modal-content input {
            width: 100%; padding: 10px; border: 3px solid #ddd;
            border-radius: 10px; font-family: inherit; font-size: 16px;
            margin-bottom: 15px; text-align: center;
        }
        .modal-btn {
            background: linear-gradient(135deg, #ff9a9e, #fecfef);
            color: white; border: none; padding: 10px 25px;
            border-radius: 20px; font-family: inherit; font-size: 14px;
            cursor: pointer; margin: 5px;
        }
        .modal-btn:hover { transform: scale(1.05); }

        .death-overlay {
            position: absolute; top: 0; left: 0; right: 0; bottom: 0;
            background: var(--screen-bg); display: none;
            flex-direction: column; align-items: center; justify-content: center;
            border-radius: 8px;
        }
        .death-overlay.active { display: flex; }
        .death-text { font-size: 10px; color: var(--screen-pixel); text-align: center; }

        .game-overlay {
            position: absolute; top: 0; left: 0; right: 0; bottom: 0;
            background: var(--screen-bg); display: none;
            flex-direction: column; align-items: center; border-radius: 8px;
        }
        .game-overlay.active { display: flex; }
        .game-title-small { font-size: 10px; color: var(--screen-pixel); margin-top: 10px; }
        .game-area {
            width: 150px; height: 80px; position: relative;
            border: 2px solid var(--screen-pixel); margin-top: 10px;
            overflow: hidden;
        }
        .player {
            position: absolute; bottom: 5px; left: 20px;
            width: 12px; height: 12px; background: var(--screen-pixel);
            border-radius: 50%; transition: bottom 0.15s;
        }
        .player.jumping { bottom: 35px; }
        .obstacle {
            position: absolute; bottom: 5px; right: -20px;
            width: 10px; height: 15px; background: var(--screen-pixel);
        }
        .game-score { font-size: 10px; color: var(--screen-pixel); margin-top: 5px; }
        .game-instruction { font-size: 8px; color: var(--screen-pixel); margin-top: 5px; }

        .action-effect {
            position: absolute; font-size: 14px;
            animation: effect-pop 0.6s ease-out forwards; pointer-events: none;
        }
        @keyframes effect-pop {
            0% { opacity: 1; transform: translateY(0) scale(1); }
            100% { opacity: 0; transform: translateY(-30px) scale(1.3); }
        }

        @media (max-width: 700px) {
            .main-container { flex-direction: column; align-items: center; }
            .stats-panel { width: 100%; max-width: 320px; margin-top: 20px; }
        }
        @media (max-width: 400px) {
            .device { width: 240px; height: 380px; }
            .screen-frame { width: 180px; height: 160px; top: 35px; }
            .screen-label { top: 200px; }
            .speaker-grille { top: 230px; }
            .bottom-buttons { bottom: 100px; }
            .controls-area { bottom: 20px; padding: 0 15px; }
            .pixel-pet { grid-template-columns: repeat(16, 5px); grid-template-rows: repeat(16, 5px); }
            .pixel { width: 5px; height: 5px; }
        }
    </style>
</head>
<body>
    <h1 class="game-title">TOMO</h1>

    <div class="cover-selector">
        <button class="cover-btn red active" data-cover="red" title="Red"></button>
        <button class="cover-btn blue" data-cover="blue" title="Blue"></button>
        <button class="cover-btn green" data-cover="green" title="Green"></button>
        <button class="cover-btn checkerboard" data-cover="checkerboard" title="Checkerboard"></button>
        <button class="cover-btn stripes" data-cover="stripes" title="Stripes"></button>
        <button class="cover-btn dots" data-cover="dots" title="Polka Dots"></button>
        <button class="cover-btn rainbow" data-cover="rainbow" title="Rainbow"></button>
        <button class="cover-btn camo" data-cover="camo" title="Camo"></button>
        <button class="cover-btn galaxy" data-cover="galaxy" title="Galaxy"></button>
        <button class="cover-btn retro" data-cover="retro" title="Retro"></button>
        <button class="cover-btn pixel" data-cover="pixel" title="Pixel"></button>
        <button class="cover-btn wood" data-cover="wood" title="Wood"></button>
    </div>

    <div class="main-container">
        <div class="device">
            <div class="device-body red" id="deviceBody">
                <div class="device-notch"></div>
                <div class="screen-frame">
                    <div class="screen" id="screen">
                        <div class="screen-icons">
                            <div class="screen-icon" id="iconHungry">üç¥</div>
                            <div class="screen-icon" id="iconHappy">üí°</div>
                            <div class="screen-icon" id="iconSick">üíÄ</div>
                            <div class="screen-icon" id="iconPoop">üí©</div>
                        </div>
                        <div class="message-bubble" id="message"></div>
                        <div class="pixel-pet-container">
                            <div class="pixel-pet" id="pixelPet"></div>
                        </div>
                        <div class="zzz-display" id="zzzDisplay">Z z z</div>
                        <div class="poop-display left" id="poop1" style="display:none;">‚óè~</div>
                        <div class="poop-display right" id="poop2" style="display:none;">‚óè~</div>
                        <div class="stats-display">
                            <div class="mini-stat"><div class="mini-stat-bar"><div class="mini-stat-fill" id="barHunger"></div></div></div>
                            <div class="mini-stat"><div class="mini-stat-bar"><div class="mini-stat-fill" id="barHappy"></div></div></div>
                            <div class="mini-stat"><div class="mini-stat-bar"><div class="mini-stat-fill" id="barEnergy"></div></div></div>
                            <div class="mini-stat"><div class="mini-stat-bar"><div class="mini-stat-fill" id="barClean"></div></div></div>
                        </div>
                        <div class="pet-info" id="petInfo"></div>
                        <div class="death-overlay" id="deathOverlay">
                            <div class="death-text">üíÄ<br>R.I.P<br><span id="deathName"></span></div>
                        </div>
                        <div class="game-overlay" id="gameOverlay">
                            <div class="game-title-small">JUMP GAME</div>
                            <div class="game-area" id="gameArea">
                                <div class="player" id="player"></div>
                                <div class="obstacle" id="obstacle"></div>
                            </div>
                            <div class="game-score">Score: <span id="gameScore">0</span></div>
                            <div class="game-instruction">Press SPACE or tap to jump!</div>
                        </div>
                    </div>
                </div>
                <div class="screen-label">TOMO</div>
                <div class="speaker-grille">
                    <div class="speaker-line"></div>
                    <div class="speaker-line"></div>
                    <div class="speaker-line"></div>
                    <div class="speaker-line"></div>
                </div>
                <div class="controls-area">
                    <div class="dpad">
                        <button class="dpad-btn dpad-up" id="dpadUp"></button>
                        <button class="dpad-btn dpad-down" id="dpadDown"></button>
                        <button class="dpad-btn dpad-left" id="dpadLeft"></button>
                        <button class="dpad-btn dpad-right" id="dpadRight"></button>
                        <div class="dpad-center"></div>
                    </div>
                    <div class="action-buttons">
                        <button class="btn btn-b" id="btnB">B</button>
                        <button class="btn" id="btnA">A</button>
                    </div>
                </div>
                <div class="bottom-buttons">
                    <button class="small-btn" id="btnSelect">SELECT</button>
                    <button class="small-btn" id="btnStart">START</button>
                </div>
            </div>
        </div>

        <!-- Stats Panel -->
        <div class="stats-panel">
            <h3>üìä <span id="panelName">Tomo</span></h3>
            
            <div class="stat-row">
                <span class="stat-label">Level</span>
                <span class="stat-value"><span id="panelLevel">1</span> (<span id="panelStage">Baby</span>)</span>
            </div>
            
            <div class="stat-bar-container">
                <div class="stat-row" style="margin-bottom:3px">
                    <span class="stat-label">EXP</span>
                    <span class="stat-value"><span id="panelExp">0</span>/<span id="panelMaxExp">100</span></span>
                </div>
                <div class="stat-bar-outer">
                    <div class="stat-bar-inner exp" id="panelExpBar" style="width:0%"></div>
                </div>
            </div>

            <hr class="stat-divider">

            <div class="stat-bar-container">
                <div class="stat-row" style="margin-bottom:3px">
                    <span class="stat-label">üçñ Hunger</span>
                    <span class="stat-value"><span id="panelHunger">100</span>%</span>
                </div>
                <div class="stat-bar-outer">
                    <div class="stat-bar-inner hunger" id="panelHungerBar" style="width:100%"></div>
                </div>
            </div>

            <div class="stat-bar-container">
                <div class="stat-row" style="margin-bottom:3px">
                    <span class="stat-label">üòä Happiness</span>
                    <span class="stat-value"><span id="panelHappy">100</span>%</span>
                </div>
                <div class="stat-bar-outer">
                    <div class="stat-bar-inner happy" id="panelHappyBar" style="width:100%"></div>
                </div>
            </div>

            <div class="stat-bar-container">
                <div class="stat-row" style="margin-bottom:3px">
                    <span class="stat-label">‚ö° Energy</span>
                    <span class="stat-value"><span id="panelEnergy">100</span>%</span>
                </div>
                <div class="stat-bar-outer">
                    <div class="stat-bar-inner energy" id="panelEnergyBar" style="width:100%"></div>
                </div>
            </div>

            <div class="stat-bar-container">
                <div class="stat-row" style="margin-bottom:3px">
                    <span class="stat-label">‚ú® Clean</span>
                    <span class="stat-value"><span id="panelClean">100</span>%</span>
                </div>
                <div class="stat-bar-outer">
                    <div class="stat-bar-inner clean" id="panelCleanBar" style="width:100%"></div>
                </div>
            </div>

            <hr class="stat-divider">

            <div class="stat-row">
                <span class="stat-label">üìÖ Age</span>
                <span class="stat-value"><span id="panelAge">0</span> days</span>
            </div>
            <div class="stat-row">
                <span class="stat-label">‚öñÔ∏è Weight</span>
                <span class="stat-value"><span id="panelWeight">5</span> kg</span>
            </div>
            <div class="stat-row">
                <span class="stat-label">üéì Discipline</span>
                <span class="stat-value"><span id="panelDisc">0</span>%</span>
            </div>
        </div>
    </div>

    <div class="bottom-controls">
        <button class="control-btn" id="btnFood">üçñ Food</button>
        <button class="control-btn" id="btnSnack">üç¨ Snack</button>
        <button class="control-btn" id="btnGame">üéÆ Game</button>
        <button class="control-btn" id="btnSleep">üí° Light</button>
        <button class="control-btn" id="btnClean">üßπ Clean</button>
        <button class="control-btn" id="btnMed">üíä Med</button>
        <button class="control-btn" id="btnPraise">üëç Praise</button>
        <button class="control-btn" id="btnReset">üîÑ Reset</button>
    </div>

    <!-- Name Modal -->
    <div class="modal" id="nameModal">
        <div class="modal-content">
            <h2>ü•ö A new pet is born!</h2>
            <input type="text" id="nameInput" placeholder="Name your pet" maxlength="8">
            <button class="modal-btn" id="nameSubmit">Start!</button>
        </div>
    </div>

    <!-- Game Over Modal -->
    <div class="modal" id="gameResultModal">
        <div class="modal-content">
            <h2>üéÆ Game Over!</h2>
            <p>Score: <span id="finalScore">0</span></p>
            <p id="gameReward"></p>
            <button class="modal-btn" id="closeGame">OK</button>
        </div>
    </div>

    <script>
        const evolutionStages = [
            { minLevel: 1, stage: 'baby', name: 'Baby' },
            { minLevel: 3, stage: 'child', name: 'Child' },
            { minLevel: 5, stage: 'teen', name: 'Teen' },
            { minLevel: 8, stage: 'adult', name: 'Adult' },
            { minLevel: 12, stage: 'special', name: 'Master' }
        ];

        const petSprites = {
            baby_normal: ['0000000000000000','0000000000000000','0000000000000000','0000001111000000','0000011111100000','0000111111110000','0000110110110000','0000111111110000','0000111001110000','0000011111100000','0000001111000000','0000000110000000','0000000000000000','0000000000000000','0000000000000000','0000000000000000'],
            baby_happy: ['0000000000000000','0000000000000000','0000000000000000','0000001111000000','0000011111100000','0000111111110000','0000111011110000','0000111111110000','0000110000110000','0000011111100000','0000001111000000','0000000110000000','0000000000000000','0000000000000000','0000000000000000','0000000000000000'],
            baby_sad: ['0000000000000000','0000000000000000','0000000000000000','0000001111000000','0000011111100000','0000111111110000','0000110110110000','0000111111110000','0000110110110000','0000011111100000','0000001111000000','0000000110000000','0000000000000000','0000000000000000','0000000000000000','0000000000000000'],
            baby_sleeping: ['0000000000000000','0000000000000000','0000000000000000','0000001111000000','0000011111100000','0000111111110000','0000111111110000','0000111111110000','0000111111110000','0000011111100000','0000001111000000','0000000000000000','0000000000000000','0000000000000000','0000000000000000','0000000000000000'],
            baby_eating: ['0000000000000000','0000000000000000','0000000000000000','0000001111000000','0000011111100000','0000111111110000','0000110110110000','0000111111110000','0000111111110000','0000011111100000','0000001111000000','0000000110000000','0000000000000000','0000000000000000','0000000000000000','0000000000000000'],
            child_normal: ['0000000000000000','0000011111100000','0000111111110000','0001111111111000','0001110110111000','0001110110111000','0001111111111000','0001111001111000','0000111111110000','0000011111100000','0000001111000000','0000011001100000','0000000000000000','0000000000000000','0000000000000000','0000000000000000'],
            child_happy: ['0000000000000000','0000011111100000','0000111111110000','0001111111111000','0001111011111000','0001110000111000','0001111111111000','0001110000111000','0000111111110000','0000011111100000','0000001111000000','0000011001100000','0000000000000000','0000000000000000','0000000000000000','0000000000000000'],
            child_sad: ['0000000000000000','0000011111100000','0000111111110000','0001111111111000','0001110110111000','0001111111111000','0001111111111000','0001110110111000','0000111111110000','0000011111100000','0000001111000000','0000011001100000','0000000000000000','0000000000000000','0000000000000000','0000000000000000'],
            child_sleeping: ['0000000000000000','0000011111100000','0000111111110000','0001111111111000','0001111111111000','0001111011111000','0001111111111000','0001111111111000','0000111111110000','0000011111100000','0000001111000000','0000000000000000','0000000000000000','0000000000000000','0000000000000000','0000000000000000'],
            child_eating: ['0000000000000000','0000011111100000','0000111111110000','0001111111111000','0001110110111000','0001110110111000','0001111111111000','0001111111111000','0000111111110000','0000011111100000','0000001111000000','0000011001100000','0000000000000000','0000000000000000','0000000000000000','0000000000000000'],
            teen_normal: ['0000001111000000','0000011111100000','0000111111110000','0001111111111000','0011111111111100','0011100110011100','0011100110011100','0011111111111100','0011111111111100','0001111001111000','0001111111111000','0000111111110000','0000011111100000','0000001111000000','0000011001100000','0000000000000000'],
            teen_happy: ['0000001111000000','0000011111100000','0000111111110000','0001111111111000','0011111111111100','0011110110111100','0011100000011100','0011111111111100','0011110000111100','0001111111111000','0001111111111000','0000111111110000','0000011111100000','0000001111000000','0000011001100000','0000000000000000'],
            teen_sad: ['0000001111000000','0000011111100000','0000111111110000','0001111111111000','0011111111111100','0011100110011100','0011110110111100','0011111111111100','0011111111111100','0001110000111000','0001111111111000','0000111111110000','0000011111100000','0000001111000000','0000011001100000','0000000000000000'],
            teen_sleeping: ['0000001111000000','0000011111100000','0000111111110000','0001111111111000','0011111111111100','0011111111111100','0011110110111100','0011111111111100','0011111111111100','0001111111111000','0001111111111000','0000111111110000','0000011111100000','0000001111000000','0000000000000000','0000000000000000'],
            teen_eating: ['0000001111000000','0000011111100000','0000111111110000','0001111111111000','0011111111111100','0011100110011100','0011100110011100','0011111111111100','0011111001111100','0001111111111000','0001111111111000','0000111111110000','0000011111100000','0000001111000000','0000011001100000','0000000000000000'],
            adult_normal: ['0000011001100000','0000111111110000','0001111111111000','0011111111111100','0011111111111100','0111100110011110','0111100110011110','0111111111111110','0011111111111100','0011110000111100','0001111111111000','0000111111110000','0000011111100000','0000111001110000','0000110000110000','0000000000000000'],
            adult_happy: ['0000011001100000','0000111111110000','0001111111111000','0011111111111100','0011111111111100','0111110110111110','0111100000011110','0111111111111110','0011111111111100','0011100000011100','0001111111111000','0000111111110000','0000011111100000','0000111001110000','0000110000110000','0000000000000000'],
            adult_sad: ['0000011001100000','0000111111110000','0001111111111000','0011111111111100','0011111111111100','0111100110011110','0111110110111110','0111111111111110','0011111111111100','0011110110111100','0001111111111000','0000111111110000','0000011111100000','0000111001110000','0000110000110000','0000000000000000'],
            adult_sleeping: ['0000011001100000','0000111111110000','0001111111111000','0011111111111100','0011111111111100','0111111111111110','0111110110111110','0111111111111110','0011111111111100','0011111111111100','0001111111111000','0000111111110000','0000011111100000','0000000000000000','0000000000000000','0000000000000000'],
            adult_eating: ['0000011001100000','0000111111110000','0001111111111000','0011111111111100','0011111111111100','0111100110011110','0111100110011110','0111111111111110','0011111111111100','0011111111111100','0001111111111000','0000111111110000','0000011111100000','0000111001110000','0000110000110000','0000000000000000'],
            special_normal: ['0000011111100000','0001100000011000','0011111111111100','0111111111111110','0111111111111110','1111100110011111','1111100110011111','1111111111111111','0111111111111110','0111110000111110','0011111111111100','0001111111111000','0000111111110000','0001110001110000','0001100000110000','0000000000000000'],
            special_happy: ['0000011111100000','0001100000011000','0011111111111100','0111111111111110','0111111111111110','1111110110111111','1111100000011111','1111111111111111','0111111111111110','0111100000011110','0011111111111100','0001111111111000','0000111111110000','0001110001110000','0001100000110000','0000000000000000'],
            special_sad: ['0000011111100000','0001100000011000','0011111111111100','0111111111111110','0111111111111110','1111100110011111','1111110110111111','1111111111111111','0111111111111110','0111110110111110','0011111111111100','0001111111111000','0000111111110000','0001110001110000','0001100000110000','0000000000000000'],
            special_sleeping: ['0000011111100000','0001100000011000','0011111111111100','0111111111111110','0111111111111110','1111111111111111','1111110110111111','1111111111111111','0111111111111110','0111111111111110','0011111111111100','0001111111111000','0000111111110000','0000000000000000','0000000000000000','0000000000000000'],
            special_eating: ['0000011111100000','0001100000011000','0011111111111100','0111111111111110','0111111111111110','1111100110011111','1111100110011111','1111111111111111','0111111111111110','0111111111111110','0011111111111100','0001111111111000','0000111111110000','0001110001110000','0001100000110000','0000000000000000'],
            egg: ['0000000000000000','0000000000000000','0000001111000000','0000011111100000','0000111111110000','0001111111111000','0001110110111000','0011111111111100','0011111111111100','0011111111111100','0011111111111100','0001111111111000','0001111111111000','0000111111110000','0000011111100000','0000000000000000'],
            ghost: ['0000000000000000','0000011111100000','0000111111110000','0001111111111000','0001100110011000','0001100110011000','0001111111111000','0001111111111000','0001111001111000','0001111111111000','0001111111111000','0001101101101000','0001010101010000','0000000000000000','0000000000000000','0000000000000000']
        };

        let game = {
            name: '', hunger: 100, happiness: 100, energy: 100, cleanliness: 100,
            level: 1, exp: 0, maxExp: 100, age: 0, weight: 5, discipline: 0, generation: 1,
            isSleeping: false, isDead: false, isSick: false, lightsOff: false,
            poopCount: 0, cover: 'red', createdAt: null, lastUpdate: null
        };

        const $ = id => document.getElementById(id);
        const pixelPetEl = $('pixelPet');
        const screen = $('screen');
        let miniGame = { active: false, score: 0, obstacleInterval: null, jumping: false };

        function getEvolutionStage(level) {
            let current = evolutionStages[0];
            for (let s of evolutionStages) if (level >= s.minLevel) current = s;
            return current;
        }

        function getSpriteKey(stage, mood) { return `${stage}_${mood}`; }

        function renderPet(spriteName) {
            const sprite = petSprites[spriteName] || petSprites.baby_normal;
            pixelPetEl.innerHTML = '';
            for (let row of sprite) {
                for (let c of row) {
                    const p = document.createElement('div');
                    p.className = c === '1' ? 'pixel on' : 'pixel';
                    pixelPetEl.appendChild(p);
                }
            }
        }

        function updateUI() {
            $('barHunger').style.width = game.hunger + '%';
            $('barHappy').style.width = game.happiness + '%';
            $('barEnergy').style.width = game.energy + '%';
            $('barClean').style.width = game.cleanliness + '%';

            $('iconHungry').classList.toggle('active', game.hunger < 40);
            $('iconHappy').classList.toggle('active', game.happiness < 40);
            $('iconSick').classList.toggle('active', game.isSick);
            $('iconPoop').classList.toggle('active', game.poopCount > 0);

            $('poop1').style.display = game.poopCount >= 1 ? 'block' : 'none';
            $('poop2').style.display = game.poopCount >= 2 ? 'block' : 'none';

            const stage = getEvolutionStage(game.level);
            $('petInfo').textContent = `Lv.${game.level} ${stage.name} ${game.weight}kg`;
            $('zzzDisplay').classList.toggle('active', game.isSleeping);
            screen.classList.toggle('lights-off', game.lightsOff);

            // Update stats panel
            $('panelName').textContent = game.name || 'Tomo';
            $('panelLevel').textContent = game.level;
            $('panelStage').textContent = stage.name;
            $('panelExp').textContent = game.exp;
            $('panelMaxExp').textContent = game.maxExp;
            $('panelExpBar').style.width = (game.exp / game.maxExp * 100) + '%';
            $('panelHunger').textContent = Math.round(game.hunger);
            $('panelHungerBar').style.width = game.hunger + '%';
            $('panelHappy').textContent = Math.round(game.happiness);
            $('panelHappyBar').style.width = game.happiness + '%';
            $('panelEnergy').textContent = Math.round(game.energy);
            $('panelEnergyBar').style.width = game.energy + '%';
            $('panelClean').textContent = Math.round(game.cleanliness);
            $('panelCleanBar').style.width = game.cleanliness + '%';
            $('panelAge').textContent = game.age;
            $('panelWeight').textContent = game.weight;
            $('panelDisc').textContent = Math.round(game.discipline);

            updatePetSprite();
        }

        function updatePetSprite() {
            if (game.isDead) {
                renderPet('ghost');
                $('deathOverlay').classList.add('active');
                $('deathName').textContent = game.name;
                return;
            }
            $('deathOverlay').classList.remove('active');
            pixelPetEl.className = 'pixel-pet';
            const stage = getEvolutionStage(game.level).stage;
            if (game.isSick) { renderPet(getSpriteKey(stage, 'sad')); pixelPetEl.classList.add('sick'); return; }
            if (game.isSleeping) { renderPet(getSpriteKey(stage, 'sleeping')); pixelPetEl.classList.add('sleeping'); return; }
            const avg = (game.hunger + game.happiness + game.energy + game.cleanliness) / 4;
            if (avg < 30) renderPet(getSpriteKey(stage, 'sad'));
            else if (avg > 70) renderPet(getSpriteKey(stage, 'happy'));
            else renderPet(getSpriteKey(stage, 'normal'));
        }

        function showMessage(text) { $('message').textContent = text; setTimeout(() => $('message').textContent = '', 2500); }
        function showEffect(emoji) {
            const e = document.createElement('div');
            e.className = 'action-effect'; e.textContent = emoji;
            e.style.left = Math.random() * 100 + 30 + 'px'; e.style.top = Math.random() * 50 + 30 + 'px';
            screen.appendChild(e); setTimeout(() => e.remove(), 600);
        }

        function addExp(amount) {
            const oldStage = getEvolutionStage(game.level);
            game.exp += amount;
            while (game.exp >= game.maxExp) {
                game.exp -= game.maxExp; game.level++; game.maxExp = Math.floor(game.maxExp * 1.5);
                const newStage = getEvolutionStage(game.level);
                if (newStage.stage !== oldStage.stage) { showMessage('EVOLVED! ‚Üí ' + newStage.name); showEffect('üåü'); showEffect('‚ú®'); }
                else { showMessage('LEVEL UP!'); showEffect('‚≠ê'); }
            }
        }

        function feedFood() {
            if (game.isDead || game.isSleeping || game.isSick) return;
            game.hunger = Math.min(100, game.hunger + 30); game.weight = Math.min(99, game.weight + 1); addExp(10);
            const stage = getEvolutionStage(game.level).stage;
            renderPet(getSpriteKey(stage, 'eating')); pixelPetEl.classList.add('eating');
            showMessage('Yummy!'); showEffect('üçñ');
            if (Math.random() < 0.3 && game.poopCount < 2) game.poopCount++;
            setTimeout(updatePetSprite, 1500); updateUI(); saveGame();
        }

        function feedSnack() {
            if (game.isDead || game.isSleeping || game.isSick) return;
            game.happiness = Math.min(100, game.happiness + 20); game.weight = Math.min(99, game.weight + 2); addExp(5);
            const stage = getEvolutionStage(game.level).stage;
            renderPet(getSpriteKey(stage, 'eating')); pixelPetEl.classList.add('eating');
            showMessage('Sweet!'); showEffect('üç¨');
            if (game.weight > 50 && Math.random() < 0.2) { game.isSick = true; showMessage('Feeling sick...'); }
            setTimeout(updatePetSprite, 1500); updateUI(); saveGame();
        }

        function toggleLight() {
            if (game.isDead) return;
            game.lightsOff = !game.lightsOff;
            game.isSleeping = game.lightsOff;
            showMessage(game.lightsOff ? 'Good night...' : 'Good morning!');
            updateUI(); saveGame();
        }

        function clean() {
            if (game.isDead || game.isSleeping) return;
            game.cleanliness = Math.min(100, game.cleanliness + 40); game.poopCount = 0; addExp(5);
            showMessage('Clean!'); showEffect('‚ú®'); updateUI(); saveGame();
        }

        function giveMedicine() {
            if (game.isDead || !game.isSick) return;
            game.isSick = false; game.happiness = Math.max(0, game.happiness - 10);
            showMessage('Cured!'); showEffect('üíä'); updateUI(); saveGame();
        }

        function praise() {
            if (game.isDead || game.isSleeping) return;
            game.discipline = Math.min(100, game.discipline + 10); game.happiness = Math.min(100, game.happiness + 5); addExp(5);
            showMessage('Good job!'); showEffect('üëç'); updateUI(); saveGame();
        }

        function startMiniGame() {
            if (game.isDead || game.isSleeping || game.isSick) return;
            if (game.energy < 20) { showMessage('Too tired...'); return; }
            miniGame.active = true; miniGame.score = 0;
            $('gameScore').textContent = '0'; $('gameOverlay').classList.add('active'); $('obstacle').style.right = '-20px';
            miniGame.obstacleInterval = setInterval(moveObstacle, 50);
        }

        function moveObstacle() {
            const obstacle = $('obstacle');
            let pos = parseInt(obstacle.style.right) || -20; pos += 3;
            if (pos > 160) { pos = -20; miniGame.score++; $('gameScore').textContent = miniGame.score; }
            obstacle.style.right = pos + 'px';
            if (pos > 100 && pos < 140 && !miniGame.jumping) endMiniGame();
        }

        function jump() {
            if (!miniGame.active || miniGame.jumping) return;
            miniGame.jumping = true; $('player').classList.add('jumping');
            setTimeout(() => { $('player').classList.remove('jumping'); miniGame.jumping = false; }, 400);
        }

        function endMiniGame() {
            clearInterval(miniGame.obstacleInterval); miniGame.active = false; $('gameOverlay').classList.remove('active');
            const score = miniGame.score;
            let happyGain = Math.min(30, score * 3), expGain = Math.min(20, score * 2);
            game.happiness = Math.min(100, game.happiness + happyGain);
            game.energy = Math.max(0, game.energy - 15); game.weight = Math.max(1, game.weight - 1); addExp(expGain);
            $('finalScore').textContent = score; $('gameReward').textContent = `+${happyGain} Happiness, +${expGain} EXP`;
            $('gameResultModal').classList.add('active'); updateUI(); saveGame();
        }

        function gameTick() {
            if (game.isDead) return;
            if (game.createdAt) game.age = Math.floor((Date.now() - game.createdAt) / (1000 * 60 * 60 * 24));
            if (game.isSleeping) { game.energy = Math.min(100, game.energy + 5); game.hunger = Math.max(0, game.hunger - 0.5); }
            else { game.hunger = Math.max(0, game.hunger - 2); game.happiness = Math.max(0, game.happiness - 1); game.energy = Math.max(0, game.energy - 1); game.cleanliness = Math.max(0, game.cleanliness - 1); }
            if (!game.isSleeping && Math.random() < 0.05 && game.poopCount < 2) { game.poopCount++; game.cleanliness = Math.max(0, game.cleanliness - 10); }
            if (!game.isSick && (game.cleanliness < 20 || game.poopCount >= 2) && Math.random() < 0.1) { game.isSick = true; showMessage('Feeling sick!'); }
            // Pet dies only if both hunger AND happiness are 0, or if sick for too long
            if ((game.hunger <= 0 && game.happiness <= 0) || (game.isSick && game.hunger <= 0)) game.isDead = true;
            updateUI(); saveGame();
        }

        function changeCover(cover) {
            game.cover = cover; $('deviceBody').className = 'device-body ' + cover;
            document.querySelectorAll('.cover-btn').forEach(b => b.classList.toggle('active', b.dataset.cover === cover));
            saveGame();
        }

        function saveGame() { game.lastUpdate = Date.now(); localStorage.setItem('tomo_save', JSON.stringify(game)); }

        function loadGame() {
            const saved = localStorage.getItem('tomo_save');
            if (saved) {
                game = { ...game, ...JSON.parse(saved) };
                if (game.lastUpdate && !game.isDead) {
                    // More forgiving offline penalty: 1 minute = 1 hunger/happiness loss, max 50
                    const offlineMinutes = Math.floor((Date.now() - game.lastUpdate) / 60000);
                    const penalty = Math.min(offlineMinutes, 50);
                    game.hunger = Math.max(10, game.hunger - penalty * 0.5);
                    game.happiness = Math.max(10, game.happiness - penalty * 0.3);
                    game.energy = Math.min(100, game.energy + penalty * 0.5); // Rest while away
                }
                if (game.createdAt) game.age = Math.floor((Date.now() - game.createdAt) / (1000 * 60 * 60 * 24));
                changeCover(game.cover || 'red'); return true;
            }
            return false;
        }

        function resetGame() {
            if (!confirm('Reset game? All data will be lost.')) return;
            localStorage.removeItem('tomo_save');
            game = { name: '', hunger: 100, happiness: 100, energy: 100, cleanliness: 100, level: 1, exp: 0, maxExp: 100, age: 0, weight: 5, discipline: 0, generation: 1, isSleeping: false, isDead: false, isSick: false, lightsOff: false, poopCount: 0, cover: 'red', createdAt: null, lastUpdate: null };
            $('deathOverlay').classList.remove('active'); $('nameModal').classList.add('active'); changeCover('red'); updateUI();
        }

        $('btnFood').onclick = feedFood; $('btnSnack').onclick = feedSnack; $('btnGame').onclick = startMiniGame;
        $('btnSleep').onclick = toggleLight; $('btnClean').onclick = clean; $('btnMed').onclick = giveMedicine;
        $('btnPraise').onclick = praise; $('btnReset').onclick = resetGame;
        $('btnA').onclick = feedFood; $('btnB').onclick = startMiniGame;
        $('btnSelect').onclick = toggleLight; $('btnStart').onclick = clean;
        document.querySelectorAll('.cover-btn').forEach(b => b.onclick = () => changeCover(b.dataset.cover));

        $('nameSubmit').onclick = () => {
            const name = $('nameInput').value.trim();
            if (name) { game.name = name; game.createdAt = Date.now(); $('nameModal').classList.remove('active'); renderPet('egg'); setTimeout(() => { showMessage(name + ' is born!'); updatePetSprite(); }, 1500); saveGame(); }
        };
        $('nameInput').onkeypress = e => { if (e.key === 'Enter') $('nameSubmit').click(); };
        $('closeGame').onclick = () => $('gameResultModal').classList.remove('active');
        document.addEventListener('keydown', e => { if (e.code === 'Space' && miniGame.active) { e.preventDefault(); jump(); } });
        $('gameArea').onclick = jump;

        function init() {
            if (!loadGame() || !game.name) { $('nameModal').classList.add('active'); renderPet('egg'); } else { updateUI(); }
            setInterval(gameTick, 5000);
        }
        init();
    </script>
</body>
</html>
